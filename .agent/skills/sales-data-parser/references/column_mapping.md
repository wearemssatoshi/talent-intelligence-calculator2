# 列構造マッピング — SVD売上日報Excel

## 概要

SVD売上日報Excelの列配置を定義する。全店舗で基本構造は共通だが、BG（ビアガーデン）列は季節により存在/不在が変動する。

## ヘッダー構造

| 行 | 役割 |
|:--|:--|
| 行0 | 注釈（※割引反映前 等） |
| 行1 | （空白） |
| 行2 | **セクション名**（LUNCH, DINNER, レストランTOTAL等） |
| 行3 | **列名**（人数合計, 料理売上, 飲料売上, 合計, 客単価等） |
| 行4〜 | **日別データ**（列1に日付） |

## 固定列（TV TOWER / GA 検証済み）

### LUNCH（列3〜10）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 3 | 日割予算 | float |
| 4 | **人数合計** | int |
| 5 | 料理売上（税込） | int |
| 6 | 料理単価（税抜） | float |
| 7 | 飲料売上（税込） | int |
| 8 | 飲料単価（税抜） | float |
| 9 | **合計（税込）** | int |
| 10 | **客単価(Ave.)** | float |

### DINNER（列11〜18）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 11 | 日割予算 | float |
| 12 | **人数合計** | int |
| 13 | 料理売上（税込） | int |
| 14 | 料理単価（税抜） | float |
| 15 | 飲料売上（税込） | int |
| 16 | 飲料単価（税抜） | float |
| 17 | **合計（税込）** | int |
| 18 | **客単価(Ave.)** | float |

### レストランTOTAL（列19〜23）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 19 | **人数** | int |
| 20 | 料理売上 | int |
| 21 | 飲料売上 | int |
| 22 | **売上** | int |
| 23 | （空白/予備） | - |

### EAT-IN・T/O（列24〜31）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 24 | 日割予算/件数 | - |
| 25 | **人数合計** | int |
| 26 | 料理売上 | int |
| 27 | 料理単価 | float |
| 28 | 飲料売上 | int |
| 29 | 飲料単価 | float |
| 30 | **合計** | int |
| 31 | 客単価(Ave.) | float |

### 宴会（列32〜39）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 32 | 件数 | int |
| 33 | **人数合計** | int |
| 34 | 料理売上 | int |
| 35 | （税抜計算用） | - |
| 36 | 飲料売上 | int |
| 37 | （税抜計算用） | - |
| 38 | **合計** | int |
| 39 | 客単価(Ave.) | float |

### ビアガーデン（列40〜48 ※動的）

> ⚠️ BG列は存在しない月あり。ヘッダー行2で「ビアガーデン」を検索して起点を特定する。

| オフセット | 内容 | 型 |
|:--|:--|:--|
| +0 | セクション開始 | - |
| +1 | **人数合計** | int |
| +2 | 料理売上 | int |
| +4 | 飲料売上 | int |
| 行3で「合計」 | **BG売上合計** | int |
| 行3で「客単価」 | 客単価 | float |

### TOTAL集計（列49〜53）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 49 | **TOTAL人数** | int |
| 50 | TOTAL料理売上 | int |
| 51 | TOTAL飲料売上 | int |
| 52 | **TOTAL売上（全チャネル）** | int |
| 53 | その他（室料等） | int |

### レストラン営業終了後トータル（列54〜63）

| 列 | 内容 | 型 |
|:--|:--|:--|
| 54 | 客数 | int |
| 55 | 料理 | int |
| 56 | 飲料 | int |
| 57 | 室料 | int |
| 58 | 展望台チケット | int |
| 59 | 花束 | int |
| 60 | 招待券 | int |
| 61 | **売上合計（花束預り金除く）** | int |
| 63 | 最終売上 | int |

## 列52 vs 列61 の違い

- **列52**: `L+D＋T/O＋宴会場+BG TOTAL` → **全チャネルの純売上合計**
- **列61**: `売上合計（花束預り金除く）` → 招待券・花束等を差し引いた最終計上額

MPの需要予測には **列52（全チャネル売上）** を使用する。
