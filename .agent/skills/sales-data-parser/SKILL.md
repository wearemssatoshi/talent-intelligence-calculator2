---
name: sales-data-parser
description: "SVDãƒ¬ã‚¹ãƒˆãƒ©ãƒ³å£²ä¸Šæ—¥å ±ï¼ˆ.xlsxï¼‰ã‚’èª­ã¿è¾¼ã¿ã€çµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®JSONã«å¤‰æ›ã™ã‚‹ã‚¹ã‚­ãƒ«ã€‚å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ã‚¹ã€æ—¥åˆ¥å£²ä¸Šã®æŠ½å‡ºã€ãƒãƒ£ãƒãƒ«åˆ¥é›†è¨ˆï¼ˆLUNCH/DINNER/T.O/å®´ä¼š/BGï¼‰ã€æœˆåˆ¥ã‚µãƒãƒªãƒ¼ã®ç”ŸæˆãŒå¿…è¦ãªæ™‚ã«ç™ºå‹•ã™ã‚‹ã€‚ã€Œå£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã‚“ã§ã€ã€ŒExcelã‚’åˆ†æã—ã¦ã€ã€Œæ—¥å ±ã‚’å–ã‚Šè¾¼ã‚“ã§ã€ç­‰ã®ãƒˆãƒªã‚¬ãƒ¼ã§èµ·å‹•ã€‚"
---

# Sales Data Parser â€” SVDå£²ä¸Šæ—¥å ±ãƒ‘ãƒ¼ã‚µãƒ¼ ğŸ“Š

SVDãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®å£²ä¸Šæ—¥å ±Excelï¼ˆ.xlsxï¼‰ã‚’èª­ã¿è¾¼ã¿ã€MPï¼ˆMomentum Peaksï¼‰äº’æ›ã®çµ±ä¸€JSONã«å¤‰æ›ã™ã‚‹ã€‚

## Core Rules

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ç†è§£

SVDã®å£²ä¸Šæ—¥å ±Excelã¯ä»¥ä¸‹ã®æ§‹é€ ã‚’æŒã¤ï¼š

- **ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ2ï¼ˆiloc[2]ï¼‰**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³åï¼ˆLUNCH, DINNER, ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³TOTAL, EAT-INãƒ»T/O, å®´ä¼š, ãƒ“ã‚¢ã‚¬ãƒ¼ãƒ‡ãƒ³, TOTALï¼‰
- **ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ3ï¼ˆiloc[3]ï¼‰**: åˆ—åï¼ˆäººæ•°åˆè¨ˆ, æ–™ç†å£²ä¸Š, é£²æ–™å£²ä¸Š, åˆè¨ˆ(ç¨è¾¼), å®¢å˜ä¾¡ ç­‰ï¼‰
- **ãƒ‡ãƒ¼ã‚¿è¡Œ**: è¡Œ4ä»¥é™ã€‚åˆ—1ã«æ—¥ä»˜ï¼ˆdatetimeå‹ï¼‰
- **åˆè¨ˆè¡Œ**: åˆ—0ã¾ãŸã¯åˆ—1ã«ã€Œåˆè¨ˆã€æ–‡å­—åˆ—ã‚’å«ã‚€è¡Œ

### ãƒãƒ£ãƒãƒ«è‡ªå‹•åˆ¤å®š

ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ2ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³åã‹ã‚‰5ãƒãƒ£ãƒãƒ«ã‚’è‡ªå‹•åˆ¤å®šï¼š

| ãƒãƒ£ãƒãƒ« | ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ2ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ | ä¸»è¦åˆ— |
|:--|:--|:--|
| LUNCH | `LUNCH` | äººæ•°(+0), æ–™ç†å£²ä¸Š(+1), é£²æ–™å£²ä¸Š(+3), åˆè¨ˆ(+5), å®¢å˜ä¾¡(+6) |
| DINNER | `DINNER` | åŒä¸Šã‚ªãƒ•ã‚»ãƒƒãƒˆ |
| T/O | `EAT-INãƒ»T/O` | äººæ•°(+1), æ–™ç†å£²ä¸Š(+2), é£²æ–™å£²ä¸Š(+4), åˆè¨ˆ(+6), å®¢å˜ä¾¡(+7) |
| å®´ä¼š | `å®´ä¼š` | äººæ•°(+1), æ–™ç†å£²ä¸Š(+2), é£²æ–™å£²ä¸Š(+4), åˆè¨ˆ(+6), å®¢å˜ä¾¡(+7) |
| BG | `ãƒ“ã‚¢ã‚¬ãƒ¼ãƒ‡ãƒ³` | äººæ•°(+1), åˆè¨ˆ=ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ3ã§ã€Œåˆè¨ˆã€ã‚’æ¢ç´¢ |

### å›ºå®šåˆ—ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆGAæ¨™æº–ï¼‰

æ¤œè¨¼æ¸ˆã¿ã®å›ºå®šåˆ—ä½ç½®ï¼ˆTV TOWER / GAï¼‰ï¼š

| åˆ— | å†…å®¹ |
|:--|:--|
| åˆ—1 | æ—¥ä»˜ |
| åˆ—4 | ãƒ©ãƒ³ãƒäººæ•° |
| åˆ—9 | ãƒ©ãƒ³ãƒå£²ä¸Šåˆè¨ˆ |
| åˆ—10 | ãƒ©ãƒ³ãƒå®¢å˜ä¾¡ |
| åˆ—12 | ãƒ‡ã‚£ãƒŠãƒ¼äººæ•° |
| åˆ—17 | ãƒ‡ã‚£ãƒŠãƒ¼å£²ä¸Šåˆè¨ˆ |
| åˆ—18 | ãƒ‡ã‚£ãƒŠãƒ¼å®¢å˜ä¾¡ |
| åˆ—19 | L+Däººæ•° |
| åˆ—22 | L+Då£²ä¸Šåˆè¨ˆ |
| åˆ—25 | T/Oäººæ•° |
| åˆ—30 | T/Oå£²ä¸Šåˆè¨ˆ |
| åˆ—33 | å®´ä¼šäººæ•° |
| åˆ—38 | å®´ä¼šå£²ä¸Šåˆè¨ˆ |
| åˆ—52 | å…¨ãƒãƒ£ãƒãƒ«å£²ä¸Šï¼ˆL+D+T/O+å®´ä¼š+BG TOTALï¼‰ |
| åˆ—61 | å£²ä¸Šåˆè¨ˆï¼ˆèŠ±æŸé ã‚Šé‡‘é™¤ãï¼‰ |

> BGåˆ—ã¯å‹•çš„ã€‚ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ2ã§ã€Œãƒ“ã‚¢ã‚¬ãƒ¼ãƒ‡ãƒ³ã€ã‚’æ¢ç´¢ã—ã€ãã®å¾Œã®ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ3ã§ã€Œåˆè¨ˆã€ã‚’æ¢ç´¢ã€‚

### å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

ãƒ‘ãƒ¼ã‚µãƒ¼ã¯ä»¥ä¸‹ã®JSONæ§‹é€ ã‚’å‡ºåŠ›ï¼š

```json
{
  "metadata": {
    "store_id": "GA",
    "store_name": "The Garden Sapporo",
    "base": "TV_TOWER",
    "fiscal_year": "2023",
    "quarter": "3Q",
    "source_file": "TV2023_3Q.xlsx",
    "parsed_at": "2026-02-11T19:50:00+09:00"
  },
  "monthly_summary": [
    {
      "month": "2023-10",
      "channels": {
        "lunch": {"pax": 914, "sales": 4375885, "avg_spend": 4787},
        "dinner": {"pax": 621, "sales": 6034125, "avg_spend": 9716},
        "ld_total": {"pax": 1535, "sales": 10410010},
        "takeout": {"pax": 301, "sales": 223480},
        "banquet": {"pax": 96, "sales": 503756},
        "beer_garden": {"pax": 76, "sales": 126240},
        "all_channels": {"sales": 11141936}
      }
    }
  ],
  "daily_data": [
    {
      "date": "2023-10-01",
      "weekday": 6,
      "channels": {
        "lunch": {"pax": 38, "sales": 186720},
        "dinner": {"pax": 7, "sales": 54500},
        "takeout": {"pax": 0, "sales": 0},
        "banquet": {"pax": 0, "sales": 0},
        "beer_garden": {"pax": 0, "sales": 0}
      }
    }
  ],
  "validation": {
    "status": "PASS",
    "checks": [
      {"check": "monthly_total_match", "result": "PASS", "detail": "å…¨æœˆã®æ—¥åˆ¥åˆç®—ã¨åˆè¨ˆè¡ŒãŒä¸€è‡´"}
    ]
  }
}
```

## Workflow

### Step 1: ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
```bash
python scripts/parse_sales_xlsx.py <input.xlsx> [--output output.json] [--store-id GA]
```

### Step 2: è‡ªå‹•æ¤œè¨¼
ãƒ‘ãƒ¼ã‚µãƒ¼ã¯è‡ªå‹•ã§ä»¥ä¸‹ã‚’æ¤œè¨¼ï¼š
1. æ—¥åˆ¥ãƒ‡ãƒ¼ã‚¿ã®åˆç®—ã¨åˆè¨ˆè¡Œã®çªãåˆã‚ã›ï¼ˆå…¨ãƒãƒ£ãƒãƒ«ï¼‰
2. ãƒ©ãƒ³ãƒ+ãƒ‡ã‚£ãƒŠãƒ¼ = L+Dåˆè¨ˆã®æ•´åˆæ€§
3. äººæ•°ãƒ»å£²ä¸Šã®å‹ãƒã‚§ãƒƒã‚¯ï¼ˆæ•°å€¤ã§ã‚ã‚‹ã“ã¨ï¼‰

### Step 3: MPçµ±åˆ
å‡ºåŠ›JSONã¯ `momentum-peaks` ã‚¹ã‚­ãƒ«ã® `momentum_calculator.py` ã«ç›´æ¥æŠ•å…¥å¯èƒ½ã€‚

## Anti-patterns

- âŒ åˆ—ç•ªå·ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã ã‘ã«é ¼ã£ã¦ã¯ã„ã‘ãªã„ï¼ˆBGã®åˆ—ä½ç½®ã¯ã‚·ãƒ¼ãƒˆã”ã¨ã«å¤‰ã‚ã‚‹ï¼‰
- âŒ åˆè¨ˆè¡Œã®ä¸€è‡´ç¢ºèªã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã¯ã„ã‘ãªã„
- âŒ å®¢å˜ä¾¡ã‚’æ•´æ•°ä¸¸ã‚ã§å ±å‘Šã—ã¦ã¯ã„ã‘ãªã„ï¼ˆExcelã®ç”Ÿå€¤ã‚’ãã®ã¾ã¾ä½¿ã†ï¼‰
- âŒ BGãŒå­˜åœ¨ã—ãªã„æœˆã§ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ã¦ã¯ã„ã‘ãªã„ï¼ˆGraceful degradationï¼‰

## References

- `references/column_mapping.md` â€” åˆ—æ§‹é€ ã®è©³ç´°å®šç¾©
- `references/channel_detection.md` â€” ãƒãƒ£ãƒãƒ«è‡ªå‹•åˆ¤å®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

## Integration

- **Momentum Peaks**: å‡ºåŠ›JSONã® `daily_data` ã‚’24ç¯€æ°—ã‚¨ãƒ³ã‚¸ãƒ³ã«æŠ•å…¥
- **Shift Scheduler**: MP Pointç®—å‡ºå¾Œã®ã‚·ãƒ•ãƒˆææ¡ˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«æ¥ç¶š
- **Talent Intelligence**: ãƒãƒ£ãƒãƒ«åˆ¥ã®å¿…è¦ã‚¹ã‚­ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°
